---
title: "Hot Dog Closeread"
subtitle: "Using closeread HTML to tell the story of Nathan's Hot Dog Eating Competition."
author: "Elena Cortina Pino"
format:
  closeread-html:
    code-fold: true
    cr-style:
      narrative-background-color-sidebar: "#09753C" # nathan's brand green
      narrative-text-color-sidebar: white
knitr:
  opts_chunk: 
    dev.args:
      bg: transparent
---

### In this demo, we'll create a plot with data from the Wikipedia page for The Story of Nathan's Hot Dog Eating Competition.
#### (https://en.wikipedia.org/wiki/Nathan%27s_Hot_Dog_Eating_Contest) 

```{r}
#| message: false
#| warning: false
library(dplyr)
library(ggplot2)
library(here)
library(plotly)
library(gghighlight)

hotdog_clean <- read.csv("C:/Users/elena/Downloads/academics/SYE Seminar/stat450-spr2026-score/hotdogs/hotdog_clean.csv")
hotdog_clean_2 <- hotdog_clean |> mutate(standard = Dogs/Time)

```

::::{.cr-section layout = "sidebar-left"}

The Story of Nathan's Hotdog Eating Competition. @cr-final

Let's take a look at the development of this historical competition. @cr-basicplot

The Nathan’s Famous Fourth of July International Hot Dog Eating Contest has a 100+ year tradition. Over time, competitors have pushed the limits of human capacity in ways no one originally imagined.


:::{#cr-basicplot}
```{r}
#| label: basicplot
#| message: false
#| warning: false

ggplot(hotdog_clean_2) +
  aes(
    x = Year,
    y = standard) +
  geom_point(
    aes(
      colour = Sex, size = 1.67), alpha = 0) +
  annotate("text", x = Inf, y = -Inf,
    label = "Years →",
    hjust = 1, vjust = -0.5) +
  annotate("text", x = -Inf, y = Inf,
    label = "↑\nDogs per\nminute",  #python string notation
    hjust = 0, vjust = 1) +
  guides(colour = "none", shape = "none") +
  theme_minimal() +
  theme(legend.position = "none") +
  labs(
    x = "Year",
    y = "Dogs eaten per minute")
```
:::

Now we can begin the story from the beginning! (Let's add the data points without formatting...) @cr-points


:::{#cr-points}
```{r}
#| label: points
#| message: false
#| warning: false

ggplot(hotdog_clean_2) +
  aes(
    x = Year,
    y = standard) +
  geom_point(
    aes(
      colour = factor(Sex), size = 1.67)) + # turned it into factor just to use scale_colour_manual()
  scale_colour_manual(values = c("#000000", "#000000"))+
  annotate("text", x = Inf, y = -Inf,
    label = "All winners throughout Nathan's History",
    hjust = 1, vjust = -0.5) +
  #annotate("text", x = -Inf, y = Inf,
  #  label = "↑\nDogs per\nminute",  #python string notation
  #  hjust = 0, vjust = 1) +
  #guides(colour = "none", shape = "none") +
  theme_minimal() +
  theme(legend.position = "none") +
  labs(
    x = "Year",
    y = "Dogs eaten per minute")
```
:::
In 2011, something breakthrough happened! Women entered the game. We can see this now! @cr-women

:::{#cr-women}
```{r}
#| label: women
#| message: false
#| warning: false

ggplot(hotdog_clean_2) +
  aes(
    x = Year,
    y = standard) +
  geom_point(
    aes(
      colour = factor(Sex), size = 1.67)) + # turned it into factor just to use scale_colour_manual()
  scale_colour_manual(values = c("#95F527", "#01401C"))+
  annotate("label", x = 1976, y = 6.5,
    label = "Women", fill = "#95F527") +
  gghighlight::gghighlight(Sex == 0) +
  #annotate("text", x = -Inf, y = Inf,
  #  label = "↑\nDogs per\nminute",  #python string notation
  #  hjust = 0, vjust = 1) +
  #guides(colour = "none", shape = "none") +
  theme_minimal() +
  theme(legend.position = "none") +
  labs(
    x = "Year",
    y = "Dogs eaten per minute")
```
:::


Let's take a closer look at the changes in the competition from 2011: @cr-population

:::{#cr-population}
```{r}
#| label: population
#| message: false
#| warning: false

ggplot(hotdog_clean_2) +
  aes(
    x = Year,
    y = standard) +
  geom_point(
    aes(
      colour = factor(Sex), size = 1.67)) + # turned it into factor just to use scale_colour_manual()
  scale_colour_manual(values = c("#95F527", "#01401C"))+
  annotate("label", x = 1976, y = 6.5,
    label = "Women", fill = "#95F527") +
  annotate("label", x = 1976, y = 7.2,
    label = "Men", fill = "#01401C", color = "#FFFFFF" ) +
  guides(colour = "none", shape = "none") +
  theme_minimal() +
  theme(legend.position = "none") +
  labs(
    x = "Year",
    y = "Dogs eaten per minute") +
  geom_vline(xintercept = 2001, linetype = 1) +
      annotate("text",
               x = 2013,
            y = 1.5, 
            size = 3.63,
            label = "→ Takeru Kobayashi enters the game")
  # annotate("rect", xmin = 2010, xmax = 2026, ymin = 2.5, ymax = 5.2, alpha = .2, fill = "blue4")
```
:::

Takeru Kobayashi intruduced some serious techniques into his competitive eating.
His strategy consisted of eating some cabbage and fasting before the contests. 

In the women's category, Miki Sudo, native to Florida, is the overall champion. @cr-mikisudo

:::{#cr-mikisudo}
```{r}
#| label: mikisudo
#| message: false
#| warning: false

miki_wins <- hotdog_clean_2 |> filter(Winner == "Miki Sudo")
ggplot(hotdog_clean_2) +
  aes(
    x = Year,
    y = standard) +
  geom_point(aes(colour = factor(Sex))) + # turned it into factor just to use scale_colour_manual()
  scale_colour_manual(values = c("#95F527", "#01401C"))+
  annotate("label", x = 1976, y = 6.5,
    label = "Women", fill = "#95F527") +
  annotate("label", x = 1976, y = 7.2,
    label = "Men", fill = "#01401C", color = "#FFFFFF" ) +
  labs(
    x = "Year",
    y = "Dogs eaten per minute") +
  #geom_vline(xintercept = 2001, linetype = 1) +
      annotate("text",
               x = 2015,
            y = 2.67, 
            size = 3.67,
            label = "Miki Sudo's wins") +
  geom_point(data = miki_wins, shape = 18, color = "#27b7a1", size = 3) +
  theme_minimal() +
  guides(colour = "none", shape = "none") +
  gghighlight::gghighlight(Winner == "Miki Sudo")
```
:::


Taking a look at the general trend of the wins: @cr-final

:::{#cr-final}
```{r}
#| label: final
#| message: false
#| warning: false

ggplot(hotdog_clean_2) +
  aes(
    x = Year,
    y = standard) +
  geom_point(
    aes(
      colour = factor(Sex))) + # turned it into factor just to use scale_colour_manual()
  scale_colour_manual(values = c("#95F527", "#01401C"))+
  annotate("label", x = 1976, y = 6.5,
    label = "Women", fill = "#95F527") +
  annotate("label", x = 1976, y = 7.2,
    label = "Men", fill = "#01401C", color = "#FFFFFF" ) +
  guides(colour = "none", shape = "none") +
  theme_minimal() +
  theme(legend.position = "none") +
  labs(
    x = "Year",
    y = "Dogs eaten per minute") +
  geom_smooth(colour = "gray")
  #geom_vline(xintercept = 2001, linetype = 1) +
      #annotate(
      #     "text",
      #      x = 2013,
      #      y = 1.5,
      #      size = 3,
      #      label = "Takeru Kobayashi enters the game") + 
  # annotate("rect", xmin = 2010, xmax = 2026, ymin = 2.5, ymax = 5.2, alpha = .2, fill = "blue4")
```
:::

There seems to be a sinusoidal trend in the hot dog wins.


::::
Thank you for scrolling!

